<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Flores Amarillas üíõ</title>
  <meta name="description" content="Una sorpresa animada con flores amarillas para alguien especial." />
  <meta property="og:title" content="Flores Amarillas üíõ" />
  <meta property="og:description" content="Toca para abrir tu sorpresa." />
  <meta property="og:type" content="website" />
  <style>
    :root{
      --bg:#0f172a;         /* slate-900 */
      --card:#111827cc;     /* neutral overlay */
      --accent:#facc15;     /* yellow-400 */
      --accent-2:#f59e0b;   /* amber-500 */
      --text:#f8fafc;       /* slate-50 */
      --muted:#cbd5e1;      /* slate-300 */
      --pink:#fb7185;       /* rose-400 */
      --green:#4ade80;      /* green-400 */
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0; font-family:system-ui,-apple-system,Segoe UI,Roboto,Inter,Ubuntu,Arial,sans-serif;
      background: radial-gradient(1200px 800px at 80% -10%, #1f2937 0%, #0b1020 40%, var(--bg) 70%),
                  radial-gradient(900px 600px at 20% 110%, #1a2436 0%, var(--bg) 60%);
      color:var(--text); overflow:hidden; -webkit-font-smoothing:antialiased; text-rendering:optimizeLegibility;
    }
    .wrap{position:relative; height:100%; display:grid; place-items:center;}

    /* Floating petals container */
    .sky{position:absolute; inset:0; overflow:hidden; pointer-events:none}

    /* Card */
    .card{
      width:min(560px, 92vw); padding:28px 24px; border-radius:22px; backdrop-filter: blur(16px) saturate(120%);
      background:linear-gradient(160deg, #111827cc, #0b1020cc 60%);
      border:1px solid #ffffff1a; box-shadow:0 20px 60px #0007, inset 0 1px 0 #fff3;
      transform:translateY(8px) scale(.98); opacity:.98;
      transition:transform .6s cubic-bezier(.2,.8,.2,1), opacity .6s;
    }
    .card.show{transform:translateY(0) scale(1); opacity:1}
    h1{margin:6px 0 0; font-size:clamp(26px, 4vw, 36px); letter-spacing:.2px}
    p{line-height:1.6; color:var(--muted); margin:.4rem 0 0}

    .badge{
      display:inline-flex; align-items:center; gap:8px; border:1px dashed #ffffff33; padding:6px 10px; border-radius:999px; color:#e5e7eb; font-size:14px
    }
    .btn{
      appearance:none; border:0; border-radius:14px; padding:14px 18px; font-weight:700; cursor:pointer; font-size:16px;
      background:linear-gradient(180deg, var(--accent) 0%, var(--accent-2) 100%);
      color:#3b2600; box-shadow: 0 10px 20px #0006, inset 0 1px 0 #fff8;
      transition: transform .15s ease, filter .2s ease, box-shadow .2s ease;
    }
    .btn:active{ transform: translateY(1px) }
    .btn.secondary{ background:#0b1226; color:#e5e7eb; border:1px solid #ffffff1a }

    .actions{display:flex; flex-wrap:wrap; gap:12px; margin-top:18px}

    /* Typewriter */
    .type{ display:inline-block; border-right:2px solid var(--accent); white-space:pre-wrap; overflow:hidden }

    /* Flower SVG base styling */
    .flower{ width:54px; height:54px; filter: drop-shadow(0 6px 10px #0006) }

    /* Entrance pop */
    .pop{ animation:pop .7s cubic-bezier(.2,.9,.2,1) both }
    @keyframes pop{ from{ transform:scale(.7); opacity:.2 } to{ transform:scale(1); opacity:1 } }

    /* Petals fall */
    .petal{ position:absolute; top:-80px; width:28px; height:28px; opacity:0; will-change: transform, opacity }
    .petal.run{ opacity:1; animation: fall var(--dur) linear var(--delay) forwards, sway 4s ease-in-out infinite alternate }
    @keyframes fall{ to { transform: translate3d(var(--x), 110vh, 0) rotate(var(--rot)) } }
    @keyframes sway{ from{ translate: -10px 0 } to{ translate: 10px 0 } }

    /* Hearts burst */
    .heart{ position:absolute; width:14px; height:14px; opacity:0; transform: translate(-50%, -50%) scale(.6); will-change:transform,opacity }
    .heart.show{ animation: burst .9s ease-out forwards }
    @keyframes burst{ 0%{opacity:0; transform:translate(-50%,-50%) scale(.4)} 15%{opacity:1; transform:translate(-50%,-60%) scale(1)} 100%{opacity:0; transform:translate(-50%,-110%) scale(0.2)} }

    /* Confetti canvas */
    canvas#confetti{ position:absolute; inset:0; pointer-events:none }

    /* Footer */
    .footer{ position:fixed; inset:auto 0 12px; text-align:center; color:#94a3b8; font-size:12px }

    /* Reduced motion */
    @media (prefers-reduced-motion: reduce){
      .petal.run, .heart.show, .pop{ animation:none }
    }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="sky" id="sky"></div>
    <canvas id="confetti"></canvas>

    <article class="card" id="card">
      <div style="display:flex; align-items:center; gap:12px;">
        <svg class="flower pop" viewBox="0 0 64 64" aria-hidden="true">
          <defs>
            <radialGradient id="g" cx="50%" cy="50%" r="60%">
              <stop offset="0%" stop-color="#fff59e"/>
              <stop offset="100%" stop-color="#facc15"/>
            </radialGradient>
          </defs>
          <circle cx="32" cy="32" r="8" fill="#7c3aed"/>
          <g fill="url(#g)">
            <circle cx="32" cy="10" r="12"/>
            <circle cx="52" cy="20" r="12"/>
            <circle cx="54" cy="42" r="12"/>
            <circle cx="32" cy="54" r="12"/>
            <circle cx="10" cy="44" r="12"/>
            <circle cx="10" cy="22" r="12"/>
          </g>
          <rect x="29.5" y="34" width="5" height="18" rx="2" fill="#22c55e"/>
        </svg>
        <div>
          <span class="badge">üíõ Flores amarillas</span>
          <h1 id="title">Para: <span id="toName">Jennifer, mi frijolito</span></h1>
          <p id="subtitle">Toca el bot√≥n para abrir tu sorpresa</p>
        </div>
      </div>

      <div style="margin-top:14px; font-size:18px;">
        <span id="message" class="type" aria-live="polite"></span>
      </div>

      <div class="actions">
        <button class="btn" id="openBtn">üåº Abrir sorpresa</button>
        <button class="btn secondary" id="shareBtn">üîó Compartir</button>
      </div>
    </article>
  </div>

<script>
/**
 * ‚≠ê Personaliza aqu√≠
 */
const SETTINGS = {
  to: getParam('to') || 'Jennifer, mi frijolito',
  lines: [
    getParam('l1') || 'Las flores amarillas dan apertura a la primavera‚Ä¶',
    getParam('l2') || 'desde el febrero de 2024 es mi primavera üíê',
    getParam('l3') || 'De lejitos pero de cerquitas, seamos una huerta de limas. üíõ'
  ],
  autoOpen: getParam('auto') === '1', // ?auto=1 abre solo
};

/** Utilidad: leer query params */
function getParam(k){ const u = new URL(location.href); return u.searchParams.get(k); }

// Pinta nombre y prepara UI
const toName = document.getElementById('toName');
const subtitle = document.getElementById('subtitle');
const msg = document.getElementById('message');
const openBtn = document.getElementById('openBtn');
const shareBtn = document.getElementById('shareBtn');
const card = document.getElementById('card');
const sky = document.getElementById('sky');
const confetti = document.getElementById('confetti');
const ctx = confetti.getContext('2d');

function fitCanvas(){ confetti.width = innerWidth; confetti.height = innerHeight; }
addEventListener('resize', fitCanvas); fitCanvas();

// Inicial
toName.textContent = SETTINGS.to;

// Generar p√©talos iniciales fuera de pantalla
const PETALS = 36;
for(let i=0;i<PETALS;i++) sky.appendChild(makePetal());

function makePetal(){
  const el = document.createElement('div');
  el.className = 'petal';
  el.innerHTML = svgPetal();
  const x = Math.random()*innerWidth + 'px';
  el.style.left = x;
  el.style.setProperty('--x', (Math.random()*120-60)+'px');
  el.style.setProperty('--rot', (Math.random()*720-360)+'deg');
  el.style.setProperty('--dur', (6 + Math.random()*6)+'s');
  el.style.setProperty('--delay', (Math.random()*1)+'s');
  return el;
}

function svgPetal(){
  return `<svg viewBox="0 0 32 32" width="28" height="28" aria-hidden="true">
    <defs>
      <radialGradient id="pg" cx="50%" cy="50%" r="60%">
        <stop offset="0%" stop-color="#fff59e"/>
        <stop offset="100%" stop-color="#facc15"/>
      </radialGradient>
    </defs>
    <path fill="url(#pg)" d="M16 2c4 4 10 4 12 8s-1 10-5 12-7 3-7 8c0-5-3-6-7-8S2 18 4 10 12 6 16 2z"/>
  </svg>`
}

// Corazones burst
function showHearts(x, y){
  for(let i=0;i<14;i++){
    const h = document.createElement('div'); h.className = 'heart';
    h.style.left = x+'px'; h.style.top = y+'px';
    h.innerHTML = `<svg viewBox="0 0 24 24" width="14" height="14"><path fill="#ffb4c6" d="M12 21s-6.7-4.35-9.33-7A5.33 5.33 0 1 1 12 5.34 5.33 5.33 0 1 1 21.33 14c-2.67 2.65-9.33 7-9.33 7z"/></svg>`;
    document.body.appendChild(h);
    requestAnimationFrame(()=> h.classList.add('show'));
    setTimeout(()=> h.remove(), 900);
  }
}

// Confetti simple
let pieces=[];
function burstConfetti(cx, cy){
  const count = 80;
  pieces = [];
  for(let i=0;i<count;i++){
    pieces.push({x:cx, y:cy, vx:(Math.random()*4-2), vy:(Math.random()*-4-1), life: 70+Math.random()*20, c: i%3});
  }
  draw();
}
function draw(){
  ctx.clearRect(0,0,confetti.width, confetti.height);
  pieces.forEach(p=>{
    p.x+=p.vx; p.y+=p.vy; p.vy+=0.08; p.life-=1;
    ctx.globalAlpha = Math.max(p.life/100,0);
    if(p.c===0) ctx.fillStyle = '#facc15'; else if(p.c===1) ctx.fillStyle = '#fde68a'; else ctx.fillStyle = '#f59e0b';
    ctx.fillRect(p.x, p.y, 6, 8);
  });
  pieces = pieces.filter(p=>p.life>0 && p.y<confetti.height+20);
  if(pieces.length) requestAnimationFrame(draw);
}

// M√°quina de escribir
async function typeLines(lines){
  msg.textContent = ''; msg.classList.add('type');
  for(const line of lines){
    await typeText(line + '\n');
  }
  msg.classList.remove('type');
}
function typeText(text){
  return new Promise(res=>{
    let i=0; const speed = 24; // ms por car√°cter
    const t = setInterval(()=>{
      msg.textContent += text[i++];
      if(i>=text.length){ clearInterval(t); res(); }
    }, speed);
  });
}

function openSurprise(sourceEvent){
  card.classList.add('show');
  subtitle.textContent = 'Con todo mi cari√±o‚Ä¶';
  document.querySelectorAll('.petal').forEach(p=>{
    p.classList.add('run');
    // reiniciar cuando llegue al final para loop suave
    p.addEventListener('animationend', () => {
      p.remove(); sky.appendChild(makePetal()).classList.add('run');
    }, { once: true });
  });
  const x = innerWidth/2, y = innerHeight*.55;
  showHearts(x,y); burstConfetti(x,y);
  typeLines(SETTINGS.lines);
}

openBtn.addEventListener('click', (e)=>{ openSurprise(e); });


// Auto abrir con ?auto=1
if(SETTINGS.autoOpen){ setTimeout(openSurprise, 600); }
</script>
</body>
</html>
